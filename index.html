<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>QB2A | ثورة البشر</title>
    <style>
        :root { --main-blue: #00f2ff; --ai-red: #ff0044; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #000; touch-action: none; }
        
        /* واجهة المعلومات */
        #hud {
            position: absolute; top: 10px; left: 10px; z-index: 10;
            color: var(--main-blue); font-family: monospace; pointer-events: none;
        }
        .server-status { color: #0f0; font-size: 12px; }

        /* أدوات التحكم للجوال (تظهر فقط في وضع اللمس) */
        #joystick-container {
            position: absolute; bottom: 40px; left: 40px; width: 120px; height: 120px;
            background: rgba(255,255,255,0.1); border-radius: 50%; display: none;
        }
        #joystick-knob {
            position: absolute; width: 50px; height: 50px; background: var(--main-blue);
            border-radius: 50%; top: 35px; left: 35px;
        }
    </style>
</head>
<body>

    <div id="hud">
        <div id="player-count">المتصلين: 1/100</div>
        <div class="server-status" id="ping">السيرفر العالمي: متصل (Global-1)</div>
    </div>

    <div id="joystick-container"><div id="joystick-knob"></div></div>

    <canvas id="gameCanvas"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        let players = [];
        let enemies = [];
        let joystickActive = false;

        // اكتشاف نوع الجهاز لتفعيل أدوات التحكم
        if ('ontouchstart' in window) {
            document.getElementById('joystick-container').style.display = 'block';
        }

        const player = {
            id: "p1",
            x: window.innerWidth / 2,
            y: window.innerHeight / 2,
            size: 20,
            color: "#00f2ff",
            speed: 5,
            bullets: []
        };

        function init() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            animate();
        }

        // تحكم لوحة المفاتيح (كمبيوتر)
        const keys = {};
        window.addEventListener('keydown', e => keys[e.key.toLowerCase()] = true);
        window.addEventListener('keyup', e => keys[e.key.toLowerCase()] = false);

        function handleInput() {
            if (keys['w'] || keys['s'] || keys['a'] || keys['d']) {
                if (keys['w']) player.y -= player.speed;
                if (keys['s']) player.y += player.speed;
                if (keys['a']) player.x -= player.speed;
                if (keys['d']) player.x += player.speed;
            }
        }

        function drawPlayer(p) {
            ctx.shadowBlur = 15;
            ctx.shadowColor = p.color;
            ctx.fillStyle = p.color;
            ctx.beginPath();
            ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
            ctx.fill();
            ctx.shadowBlur = 0;
            
            // رسم اسم اللاعب
            ctx.fillStyle = "#fff";
            ctx.font = "12px Arial";
            ctx.textAlign = "center";
            ctx.fillText("بشري_1", p.x, p.y - 30);
        }

        function drawAIEnemy() {
            // منطق بسيط لعدو ذكاء اصطناعي (مكعب أحمر)
            ctx.fillStyle = "#ff0044";
            ctx.fillRect(100, 100, 30, 30); // مثال لموقع العدو
        }

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // رسم شبكة الخلفية (Grid) لتعطي إحساس السيرفر
            ctx.strokeStyle = "#111";
            for(let i=0; i<canvas.width; i+=50) {
                ctx.beginPath(); ctx.moveTo(i,0); ctx.lineTo(i,canvas.height); ctx.stroke();
            }
            for(let i=0; i<canvas.height; i+=50) {
                ctx.beginPath(); ctx.moveTo(0,i); ctx.lineTo(canvas.width,i); ctx.stroke();
            }

            handleInput();
            drawPlayer(player);
            drawAIEnemy();

            requestAnimationFrame(animate);
        }

        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

        init();
    </script>
</body>
</html>
